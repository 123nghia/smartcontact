
# üßæ TestToken - BEP-20 Utility Token

### üß† D·ª± √°n: TestToken (BEP-20 Utility Token)
**M·ª•c ti√™u:** Tri·ªÉn khai token ti·ªán √≠ch v·ªõi ƒë·∫ßy ƒë·ªß t√≠nh nƒÉng qu·∫£n l√Ω n√¢ng cao: Cap/Mint/Burn/Pause/Blacklist/AccessControl tr√™n Hardhat Devnet v√† Testnet.

**Tr·∫°ng th√°i:** ‚úÖ **Production Ready** - Smart contract ƒë√£ ƒë∆∞·ª£c ki·ªÉm tra v√† s·∫µn s√†ng tri·ªÉn khai

---

## ‚öôÔ∏è 1Ô∏è‚É£ Y√äU C·∫¶U M√îI TR∆Ø·ªúNG

| C√¥ng c·ª• | Phi√™n b·∫£n khuy·∫øn ngh·ªã |
|----------|-----------------------|
| Node.js  | ‚â• 18.x |
| Hardhat  | 2.22.x |
| Ethers.js | 6.x |
| OpenZeppelin Contracts | 4.9.6 |
| NPM | ‚â• 9.x |

---

## üìÅ 2Ô∏è‚É£ C·∫§U TR√öC D·ª∞ √ÅN

```
smartfolder3/
‚îú‚îÄ‚îÄ contracts/
‚îÇ   ‚îú‚îÄ‚îÄ TestToken.sol           # Contract ch√≠nh - Token BEP-20
‚îÇ   ‚îú‚îÄ‚îÄ AdminManager.sol        # Qu·∫£n l√Ω admin roles v·ªõi b·∫£o v·ªá
‚îÇ   ‚îú‚îÄ‚îÄ BlacklistManager.sol    # Qu·∫£n l√Ω blacklist system
‚îÇ   ‚îú‚îÄ‚îÄ ITestToken.sol          # Interface v·ªõi custom errors/events
‚îÇ   ‚îú‚îÄ‚îÄ ITestTokenErrors.sol    # Custom errors definitions
‚îÇ   ‚îî‚îÄ‚îÄ ITestTokenEvents.sol    # Custom events definitions
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ deploy.js               # Deploy script ch√≠nh
‚îÇ   ‚îî‚îÄ‚îÄ test-bsc.js             # Test script cho BSC
‚îú‚îÄ‚îÄ test/
‚îÇ   ‚îú‚îÄ‚îÄ TestToken.js            # Test suite ch√≠nh
‚îÇ   ‚îî‚îÄ‚îÄ Lock.js                 # Test m·∫´u Hardhat
‚îú‚îÄ‚îÄ devnet-tests/               # Th∆∞ m·ª•c test devnet
‚îÇ   ‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deploy-and-test.js  # Deploy v√† test t·ª± ƒë·ªông
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test-devnet.js      # Test devnet chi ti·∫øt
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ run-tests.js        # Ch·∫°y test suite
‚îÇ   ‚îú‚îÄ‚îÄ deployments/            # Deployment records
‚îÇ   ‚îî‚îÄ‚îÄ reports/                # Test reports
‚îú‚îÄ‚îÄ artifacts/                  # Compiled contracts
‚îú‚îÄ‚îÄ cache/                      # Hardhat cache
‚îú‚îÄ‚îÄ deployments/                # Deployment records
‚îú‚îÄ‚îÄ reports/                    # Gas reports
‚îú‚îÄ‚îÄ hardhat.config.js           # Hardhat configuration
‚îú‚îÄ‚îÄ package.json                # Dependencies
‚îú‚îÄ‚îÄ TEST_GUIDE.md              # H∆∞·ªõng d·∫´n test
‚îî‚îÄ‚îÄ README.md                   # Documentation n√†y
```

---

## ü™ô 3Ô∏è‚É£ M√î T·∫¢ CONTRACT

**T√™n Token:** `test`  
**K√Ω hi·ªáu:** `TEST`  
**Decimals:** 18  
**T·ªïng cung t·ªëi ƒëa (cap):** 1,000,000,000 TEST  
**Chu·∫©n:** BEP-20 (t∆∞∆°ng th√≠ch ERC-20)  
**Solidity Version:** ^0.8.28  
**OpenZeppelin:** v4.9.6 (Audit-ready)

### üîß **T√≠nh nƒÉng ch√≠nh:**

#### ‚úÖ **Token Management**
- **Mint**: T·∫°o token m·ªõi (ch·ªâ MINTER_ROLE)
- **Burn**: ƒê·ªët token (t·ª± burn ho·∫∑c burn t·ª´)
- **Transfer**: Chuy·ªÉn token v·ªõi pause protection
- **Approve**: ·ª¶y quy·ªÅn chi ti√™u v·ªõi blacklist check
- **Cap**: Gi·ªõi h·∫°n t·ªïng cung 1 t·ª∑ token

#### ‚úÖ **Security System**
- **Pause/Unpause**: T·∫°m d·ª´ng to√†n b·ªô giao d·ªãch (ch·ªâ PAUSER_ROLE)
- **Blacklist**: Ch·∫∑n ƒë·ªãa ch·ªâ c·ª• th·ªÉ
  - Ch·∫∑n transfer t·ª´/t·ªõi ƒë·ªãa ch·ªâ blacklist
  - Ch·∫∑n mint cho ƒë·ªãa ch·ªâ blacklist  
  - Ch·∫∑n burn t·ª´ ƒë·ªãa ch·ªâ blacklist
  - Ch·∫∑n approve cho ƒë·ªãa ch·ªâ blacklist
- **Batch Blacklist**: Blacklist nhi·ªÅu ƒë·ªãa ch·ªâ c√πng l√∫c

#### ‚úÖ **Access Control (Role-based)**
- **DEFAULT_ADMIN_ROLE**: Qu·∫£n l√Ω t·∫•t c·∫£ roles
- **MINTER_ROLE**: Quy·ªÅn mint tokens
- **PAUSER_ROLE**: Quy·ªÅn pause/unpause
- **BLACKLISTER_ROLE**: Quy·ªÅn qu·∫£n l√Ω blacklist
- **B·∫£o v·ªá**: Kh√¥ng cho ph√©p renounce admin cu·ªëi c√πng

#### ‚úÖ **Emergency Features**
- **Emergency Withdraw**: R√∫t token kh·∫©n c·∫•p (ch·ªâ admin)
- **Pause Protection**: T·∫•t c·∫£ transfer/approve b·ªã v√¥ hi·ªáu h√≥a khi pause

#### ‚úÖ **Utility Functions**
- **View Functions**: Xem th√¥ng tin token, s·ªë d∆∞, tr·∫°ng th√°i
- **Batch Operations**: Xem s·ªë d∆∞ nhi·ªÅu ƒë·ªãa ch·ªâ c√πng l√∫c
- **Account Info**: Xem ƒë·∫ßy ƒë·ªß th√¥ng tin t√†i kho·∫£n (balance, roles, blacklist)
- **Mintable Check**: Ki·ªÉm tra s·ªë token c√≤n c√≥ th·ªÉ mint

#### ‚úÖ **Integration**
- **OpenZeppelin**: ERC20, ERC20Burnable, ERC20Capped, Pausable, AccessControl
- **Custom Errors**: Thay v√¨ require ƒë·ªÉ ti·∫øt ki·ªám gas
- **Events**: ƒê·∫ßy ƒë·ªß events cho tracking

---

---

## üß© 4Ô∏è‚É£ C√ÄI ƒê·∫∂T & C·∫§U H√åNH

### üì¶ **C√†i ƒë·∫∑t dependencies:**
```bash
npm install --save-dev hardhat @nomicfoundation/hardhat-toolbox @openzeppelin/contracts@4.9.6 dotenv
```

### üîê **C·∫•u h√¨nh bi·∫øn m√¥i tr∆∞·ªùng (`.env` v√≠ d·ª•):**
```bash
# RPC endpoints
BSC_TESTNET_RPC_URL=https://bsc-testnet-rpc.publicnode.com
BSC_MAINNET_RPC_URL=https://bsc-dataseed1.bnbchain.org
SEPOLIA_RPC_URL=https://eth-sepolia.g.alchemy.com/v2/your-key

# Private keys
DEV_PRIVATE_KEY=0xabc...
PROD_PRIVATE_KEY=0xdef...

# (T√πy ch·ªçn) √©p Hardhat d√πng chainId BSC testnet khi dev local
LOCAL_CHAIN_ID=97

# Explorer API keys
ETHERSCAN_API_KEY=your-etherscan-key
BSCSCAN_API_KEY=your-bscscan-key

# Gas reporter
REPORT_GAS=false
GAS_REPORTER_OFFLINE=true
COINMARKETCAP_API_KEY=your-cmc-key
```

### ‚öôÔ∏è **C·∫•u h√¨nh Hardhat (`hardhat.config.js`):**
```js
require("@nomicfoundation/hardhat-toolbox");
require("hardhat-gas-reporter");
require("dotenv").config();

const {
  DEV_PRIVATE_KEY,
  PROD_PRIVATE_KEY,
  PRIVATE_KEY,
  BSC_TESTNET_RPC_URL,
  BSC_MAINNET_RPC_URL,
  SEPOLIA_RPC_URL,
  ETHERSCAN_API_KEY,
  BSCSCAN_API_KEY,
  REPORT_GAS,
  COINMARKETCAP_API_KEY,
  GAS_REPORTER_OFFLINE,
  LOCAL_CHAIN_ID,
} = process.env;

const parseChainId = (value, fallback) => {
  if (!value) return fallback;
  const parsed = Number.parseInt(value, 10);
  return Number.isNaN(parsed) ? fallback : parsed;
};

const devAccounts = (DEV_PRIVATE_KEY || PRIVATE_KEY)
  ? [DEV_PRIVATE_KEY || PRIVATE_KEY]
  : [];

const prodAccounts = PROD_PRIVATE_KEY
  ? [PROD_PRIVATE_KEY]
  : devAccounts;

module.exports = {
  solidity: {
    version: "0.8.28",
    settings: {
      optimizer: { enabled: true, runs: 200 },
      evmVersion: "london",
    },
  },
  networks: {
    hardhat: {
      chainId: parseChainId(LOCAL_CHAIN_ID, 31337),
    },
    localhost: {
      url: "http://127.0.0.1:8545",
      chainId: parseChainId(LOCAL_CHAIN_ID, 31337),
      accounts: devAccounts,
    },
    sepolia: {
      url: SEPOLIA_RPC_URL || "https://eth-sepolia.g.alchemy.com/v2/demo",
      accounts: devAccounts,
      chainId: 11155111,
    },
    bscTestnet: {
      url: BSC_TESTNET_RPC_URL || "https://bsc-testnet-rpc.publicnode.com",
      accounts: devAccounts,
      chainId: 97,
    },
    bsc: {
      url: BSC_MAINNET_RPC_URL || "https://bsc-dataseed1.bnbchain.org",
      accounts: prodAccounts,
      chainId: 56,
    },
  },
  gasReporter: {
    enabled: REPORT_GAS === "true",
    currency: "USD",
    token: "BNB",
    coinmarketcap: COINMARKETCAP_API_KEY || "",
    noColors: true,
    outputFile: "gas-report.txt",
    offline: GAS_REPORTER_OFFLINE === "true",
  },
  etherscan: {
    apiKey: {
      mainnet: ETHERSCAN_API_KEY || "",
      sepolia: ETHERSCAN_API_KEY || "",
      goerli: ETHERSCAN_API_KEY || "",
      bsc: BSCSCAN_API_KEY || "",
      bscTestnet: BSCSCAN_API_KEY || "",
    },
  },
};
```

---

## üß™ 5Ô∏è‚É£ COMPILE CONTRACT
```bash
npx hardhat clean
npx hardhat compile
```

---

## üß† 6Ô∏è‚É£ CH·∫†Y DEVNET
```bash
npx hardhat node
```

---

## üöÄ 7Ô∏è‚É£ DEPLOY CONTRACT

### **Deploy l√™n localhost:**
```bash
npx hardhat run scripts/deploy.js --network localhost
```

### **Deploy l√™n BSC Testnet:**
```bash
npx hardhat run scripts/deploy.js --network bscTestnet
```

### **Deploy l√™n BSC Mainnet (Production):**
```bash
npx hardhat run scripts/deploy.js --network bsc
```

### **Script deploy.js:**
```js
const hre = require("hardhat");

async function main() {
  const [deployer] = await hre.ethers.getSigners();
  console.log("üöÄ Deploying contracts with:", deployer.address);

  const balance = await hre.ethers.provider.getBalance(deployer.address);
  console.log("üí∞ Deployer balance:", hre.ethers.formatEther(balance), "ETH");

  const TestToken = await hre.ethers.getContractFactory("TestToken");
  const token = await TestToken.deploy(deployer.address);
  await token.waitForDeployment();

  const tokenAddress = await token.getAddress();
  console.log("‚úÖ TestToken deployed at:", tokenAddress);
  
  // In th√¥ng tin token
  console.log("üìã Token Info:");
  console.log("  Name:", await token.name());
  console.log("  Symbol:", await token.symbol());
  console.log("  Decimals:", await token.decimals());
  console.log("  Total Supply:", (await token.totalSupply()).toString());
  console.log("  Cap:", (await token.cap()).toString());
}

main().catch((error) => {
  console.error("‚ùå Deploy failed:", error);
  process.exitCode = 1;
});
```

---

## üß† 8Ô∏è‚É£ T∆Ø∆†NG T√ÅC QUA CONSOLE
```bash
npx hardhat console --network localhost
```

### **C√°c l·ªánh h·ªØu √≠ch:**
```js
// K·∫øt n·ªëi contract
const token = await ethers.getContractAt("TestToken", "CONTRACT_ADDRESS");

// Xem th√¥ng tin c∆° b·∫£n
await token.name();                    // "test"
await token.symbol();                  // "TEST"
await token.decimals();                // 18
await token.totalSupply();             // T·ªïng cung hi·ªán t·∫°i
await token.cap();                     // T·ªïng cung t·ªëi ƒëa

// Xem th√¥ng tin account
await token.getAccountInfo("ADDRESS"); // balance, blacklist, roles
await token.getTokenInfo();            // T·∫•t c·∫£ th√¥ng tin token

// Ki·ªÉm tra roles
await token.hasRole(await token.DEFAULT_ADMIN_ROLE(), "ADDRESS");
await token.hasRole(await token.MINTER_ROLE(), "ADDRESS");
await token.hasRole(await token.PAUSER_ROLE(), "ADDRESS");
await token.hasRole(await token.BLACKLISTER_ROLE(), "ADDRESS");

// Ki·ªÉm tra tr·∫°ng th√°i
await token.isPaused();                // false
await token.isBlacklisted("ADDRESS");  // false

// Mint tokens (ch·ªâ admin/minter)
await token.mint("ADDRESS", ethers.parseEther("1000"));

// Blacklist (ch·ªâ blacklister)
await token.setBlacklisted("ADDRESS", true);

// Pause contract (ch·ªâ pauser)
await token.pause();
await token.unpause();
```

---

## üß© 9Ô∏è‚É£ KI·ªÇM TRA TRONG METAMASK

### **Network: Hardhat Devnet**
```
Network Name: Hardhat Local
RPC URL: http://127.0.0.1:8545
Chain ID: 31337
Currency Symbol: ETH
```
> üí° ƒê·∫∑t `LOCAL_CHAIN_ID=97` trong `.env` n·∫øu mu·ªën Hardhat gi·∫£ l·∫≠p BSC Testnet (gas v·∫´n l√† ETH nh∆∞ng chainId ph√π h·ª£p).

### **Add Custom Token:**
```
Token Contract Address: [CONTRACT_ADDRESS_FROM_DEPLOY]
Token Symbol: TEST
Decimals: 18
```

---

## üß™ 10Ô∏è‚É£ CH·∫†Y TEST

### **Test c∆° b·∫£n:**
```bash
# Ch·∫°y t·∫•t c·∫£ test
npx hardhat test

# Ch·∫°y test c·ª• th·ªÉ
npx hardhat test test/TestToken.js

# Ch·∫°y test v·ªõi gas reporting
REPORT_GAS=true npx hardhat test
```

### **Test Devnet (T·ª± ƒë·ªông):**
```bash
# Ch·∫°y test devnet ƒë·∫ßy ƒë·ªß
cd devnet-tests
./scripts/start-devnet-test.sh

# Ho·∫∑c ch·∫°y t·ª´ng b∆∞·ªõc
npx hardhat node                    # Terminal 1
cd devnet-tests
node scripts/deploy-and-test.js     # Terminal 2
```

### **Test BSC Testnet:**
```bash
# Test tr√™n BSC Testnet
node scripts/test-bsc.js
```

---

## üåê 11Ô∏è‚É£ TRI·ªÇN KHAI L√äN TESTNET

### **BSC Testnet:**
```bash
# C·∫•u h√¨nh .env file
DEV_PRIVATE_KEY=0xabc...                 # v√≠ dev/staging
BSC_TESTNET_RPC_URL=https://bsc-testnet-rpc.publicnode.com

# Deploy
npx hardhat run scripts/deploy.js --network bscTestnet

# Verify contract
npx hardhat verify --network bscTestnet CONTRACT_ADDRESS DEPLOYER_ADDRESS
```

### **BSC Mainnet (Production):**
```bash
PROD_PRIVATE_KEY=0xprod...
BSC_MAINNET_RPC_URL=https://bsc-dataseed1.bnbchain.org

npx hardhat run scripts/deploy.js --network bsc
npx hardhat verify --network bsc CONTRACT_ADDRESS DEPLOYER_ADDRESS
```

---

## üîê 12Ô∏è‚É£ B·∫¢O M·∫¨T & AUDIT

### **T√≠nh nƒÉng b·∫£o m·∫≠t:**
- ‚úÖ **Custom Errors**: Thay v√¨ require ƒë·ªÉ ti·∫øt ki·ªám gas
- ‚úÖ **Reentrancy Protection**: T·ª´ OpenZeppelin contracts
- ‚úÖ **Input Validation**: ƒê·∫ßy ƒë·ªß ki·ªÉm tra ƒë·∫ßu v√†o
- ‚úÖ **Role-based Access Control**: 4 roles v·ªõi ph√¢n quy·ªÅn r√µ r√†ng
- ‚úÖ **Emergency Pause**: C∆° ch·∫ø t·∫°m d·ª´ng kh·∫©n c·∫•p
- ‚úÖ **Blacklist Protection**: Ch·∫∑n t·∫•t c·∫£ operations c·ªßa ƒë·ªãa ch·ªâ blacklist
- ‚úÖ **Admin Protection**: B·∫£o v·ªá ch·ªëng renounce admin cu·ªëi c√πng
- ‚úÖ **Zero Address Check**: Ki·ªÉm tra ƒë·ªãa ch·ªâ zero
- ‚úÖ **Cap Protection**: Gi·ªõi h·∫°n t·ªïng cung

### **Chu·∫©n audit:**
- ‚úÖ **OpenZeppelin v4.9.6**: Audit-ready contracts
- ‚úÖ **Solidity ^0.8.28**: Phi√™n b·∫£n ·ªïn ƒë·ªãnh
- ‚úÖ **Gas Optimization**: Enabled v·ªõi 200 runs
- ‚úÖ **Comprehensive Tests**: Test coverage ƒë·∫ßy ƒë·ªß
- ‚úÖ **Custom Events**: Tracking ƒë·∫ßy ƒë·ªß
- ‚úÖ **Error Handling**: Custom errors thay v√¨ strings

### **M·ª©c ƒë·ªô b·∫£o m·∫≠t:**
- üõ°Ô∏è **High**: S·ª≠ d·ª•ng OpenZeppelin audit-ready
- üõ°Ô∏è **Multi-layer**: Pause + Blacklist + Access Control
- üõ°Ô∏è **Emergency Ready**: C√≥ th·ªÉ x·ª≠ l√Ω t√¨nh hu·ªëng kh·∫©n c·∫•p

---

## ‚úÖ 13Ô∏è‚É£ T·ªîNG K·∫æT

| Th√†nh ph·∫ßn | Tr·∫°ng th√°i | Ghi ch√∫ |
|-------------|------------|---------|
| **Core Features** | ‚úÖ | Mint/Burn/Cap/Pause/Blacklist |
| **Access Control** | ‚úÖ | 4 roles v·ªõi b·∫£o v·ªá admin |
| **Emergency Features** | ‚úÖ | Pause + Emergency withdraw |
| **Utility Functions** | ‚úÖ | Batch operations + info views |
| **Security** | ‚úÖ | Audit-ready v·ªõi OpenZeppelin |
| **Testing** | ‚úÖ | Comprehensive test suite |
| **Devnet Testing** | ‚úÖ | Automated devnet test suite |
| **BSC Testnet** | ‚úÖ | BSC Testnet ready |
| **BSC Mainnet** | ‚úÖ | Production ready |
| **Gas Optimization** | ‚úÖ | Optimized v·ªõi custom errors |
| **Documentation** | ‚úÖ | Complete README + Test Guide |

### **üéØ M·ª•c ƒë√≠ch s·ª≠ d·ª•ng:**
- **DeFi Projects**: Token ti·ªán √≠ch cho d·ª± √°n DeFi
- **Utility Token**: Token c√≥ y√™u c·∫ßu b·∫£o m·∫≠t cao
- **Ecosystem Token**: Token trong h·ªá sinh th√°i blockchain
- **Enterprise Use**: ·ª®ng d·ª•ng doanh nghi·ªáp c·∫ßn ki·ªÉm so√°t ch·∫∑t ch·∫Ω

### **üöÄ S·∫µn s√†ng tri·ªÉn khai:**
- ‚úÖ **Smart Contract**: Ho√†n thi·ªán v√† audit-ready
- ‚úÖ **Testing**: Test suite ƒë·∫ßy ƒë·ªß
- ‚úÖ **Deployment**: Scripts s·∫µn s√†ng
- ‚úÖ **Documentation**: H∆∞·ªõng d·∫´n chi ti·∫øt
- ‚úÖ **Security**: Multi-layer protection

---

## üìû 14Ô∏è‚É£ SUPPORT & CONTACT

- **Issues**: [GitHub Issues](https://github.com/your-repo/issues)
- **Documentation**: [Wiki](https://github.com/your-repo/wiki)
- **License**: MIT License ¬© 2025

---

## üìö 15Ô∏è‚É£ T√ÄI LI·ªÜU THAM KH·∫¢O

### **OpenZeppelin Contracts:**
- [ERC20 Documentation](https://docs.openzeppelin.com/contracts/4.x/erc20)
- [Access Control](https://docs.openzeppelin.com/contracts/4.x/access-control)
- [Pausable](https://docs.openzeppelin.com/contracts/4.x/security#pausable)

### **BSC Network:**
- [BSC Testnet](https://testnet.bscscan.com/)
- [BSC Mainnet](https://bscscan.com/)
- [BSC RPC Endpoints](https://docs.bnbchain.org/docs/rpc)

### **Hardhat:**
- [Hardhat Documentation](https://hardhat.org/docs)
- [Hardhat Network](https://hardhat.org/hardhat-network/docs)

---

**üéâ TestToken - Production Ready Smart Contract!**

*Smart contract BEP-20 utility token v·ªõi ƒë·∫ßy ƒë·ªß t√≠nh nƒÉng b·∫£o m·∫≠t v√† qu·∫£n l√Ω, s·∫µn s√†ng tri·ªÉn khai tr√™n BSC v√† c√°c m·∫°ng t∆∞∆°ng th√≠ch.*
